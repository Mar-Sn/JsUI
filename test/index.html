<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <link rel="stylesheet" href="css/panel.css" type="text/css">
    <link rel="stylesheet" href="css/table.css" type="text/css">
    <link rel="stylesheet" href="css/button.css" type="text/css">
    <link rel="stylesheet" href="css/popup.css" type="text/css">
    <link rel="stylesheet" href="css/grid.css" type="text/css">
    <link rel="stylesheet" href="lib/libs/trumbowyg/dist/ui/trumbowyg.min.css">
    <script type="application/javascript" src="/lib/requirejs.js"></script>
    <script>
        require.config({
            baseUrl: 'lib',
            paths: {
                jquery: 'jquery.min',
                Random: 'random',
                Popup: 'popup',
                Input: 'input',
                FieldSetInput: 'fieldset_input',
                Button: 'button',
                Grid: 'grid',
                Table: 'table',
                Div: 'div',
                Panel: 'panel',
                Component: 'component',
                TableComponent: 'table_component',
                Draggable: 'libs/table-dragger/table-dragger.min',
                Moments: 'libs/moment-timezone/moment-timezone.min',
                trumbowyg: 'libs/trumbowyg/dist/trumbowyg.min'
            },
            shim:{
                'trumbowyg': {
                    deps: ['jquery'],
                    exports: 'trumbowyg'
                }
            }
        });
        require(['jquery', 'Popup', 'Panel', 'FieldSetInput', 'Table', 'Button', 'Grid', 'TableComponent', 'Div'],
            function ($, Popup, Panel, FieldSetInput, Table, Button, Grid, TableComponent, Div) {
            var popup = new Popup.Popup("test", function () {
                //onclose
                alert("popup closed");
            });
            var panel = new Panel.Panel("Panel1", ["input", "test"]);

            var input = new FieldSetInput.FieldSetInput('name', 'text', '', 'simple description', ['some','classes'], '');
            input.onChange(function (data) {
                console.log(data);
            });
            panel.append(input);

            var panel1 = new Panel.Panel("Panel2", ["table","test"]);


            var object = [{name: "", sub: {}}, {name: "", sub: {}}];

            var table = new Table.Table([
                "text",
                "number",
                "date",
                "boolean",
                "text sub",
                "number sub",
                "boolean sub",
            ], "", object);


            var table2 = new Table.Table(['custom component']);
            var table_button = new Button.Button("another test",'', function () {
                alert('button works from table');

            });
            table2.addRow([
                {
                    type: "readonly",
                    key: '',
                    value: '',
                    component: table_button
                }]);


            table.addRows([[
                {type: "text", key: 'name', value: object[0].name, mappedValue: object[0]},
                {type: "number", key: 'number', value: object[0].number, mappedValue: object[0]},
                {type: "datetime", key: 'datetime', value: object[0].datetime, mappedValue: object[0]},
                {type: "boolean", key: 'boolean', value: object[0].boolean, mappedValue: object[0]},

                {type: "text", key: 'name', value: object[0].sub.name, mappedValue: object[0].sub},
                {type: "number", key: 'number', value: object[0].sub.number, mappedValue: object[0].sub},
                {type: "datetime", key: 'datetime', value: object[0].sub.datetime, mappedValue: object[0].sub},
                {type: "boolean", key: 'boolean', value: object[0].sub.boolean, mappedValue: object[0].sub}
            ], [
                {type: "text", key: 'name', value: object[1].name, mappedValue: object[1]},
                {type: "number", key: 'number', value: object[1].number, mappedValue: object[1]},
                {type: "date", key: 'date', value: object[1].date, mappedValue: object[1]},
                {type: "boolean", key: 'boolean', value: object[1].boolean, mappedValue: object[1]},

                {type: "text", key: 'name', value: object[1].sub.name, mappedValue: object[1].sub},
                {type: "number", key: 'number', value: object[1].sub.number, mappedValue: object[1].sub},
                {type: "date", key: 'date', value: object[1].sub.date, mappedValue: object[1].sub},
                {type: "boolean", key: 'boolean', value: object[1].sub.boolean, mappedValue: object[1].sub},
            ]]);
            panel1.set(table);


            var panel2 = new Panel.Panel("Panel2", ["table","test"]);
            panel2.set(new Button.Button("test", '', function () {
                alert('button works');
            }));


            var panel3 = new Panel.Panel("Panel3", ["Test","custom","compontent"]);
            panel3.set(table2);



            var panel4 = new Panel.Panel("Panel 4", ["Test","grid"]);


            var gridDate = [];

            var grid = new Grid.Grid('grid', gridDate);
            panel4.set(grid);
            panel4.append(new Button.Button('Grid data to console','', function(){
                console.log(grid.getData());
            }));

            var body = document.getElementsByTagName("body").item(0);
            body.appendChild(panel.getElement());
            body.appendChild(panel1.getElement());
            body.appendChild(panel2.getElement());
            body.appendChild(panel3.getElement());
            body.appendChild(panel4.getElement());


            body.appendChild(new Div.Div('panel', new Div.Div('inner1'), new Div.Div('inner2'))
                .addElement(new Div.Div('panel'))
                .addElement(document.createElement("div")) //testing a plain JS HTMLElement
                .getElement()
            );

            window.testObject = object;
        });
    </script>
</head>
<body>

</body>
</html>